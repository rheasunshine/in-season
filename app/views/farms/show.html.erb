  <div class="parallax-container">
    <div class="parallax"><img src=<%=@farm.banner_image%>></div>
  </div>

  <div class="section white">
    <div class="row valign-wrapper">
      <div class="profile-image col l2 offset-l1 valign">
        <img alt="" src=<%=@farm.profile_image%> class="circle">
      </div>

      <div class="names col l6">
        <ul>
          <li>
            <h2><%= best_in_place_if (current_user && current_user.id == @farm.user_id), @farm, :name, :as => :input, type: :textarea, placeholder: "What is the name of your farm?",  ok_button: 'Save', cancel_button: 'Cancel' %></h2>
          </li>
          <div class="card-content grey-text text-darken-1">
            <li>
              <h5><%= best_in_place_if (current_user && current_user.id == @farm.user_id), @farm, :farmer, :as => :input, placeholder: "Who are your farmers?",  ok_button: 'Save', cancel_button: 'Cancel' %>
              </h5>
            </li>
          </div>
        </ul>
      </div>
      <div class="safety col l1 valign">
        <img src="http://www.jamacfoods.com/wp-content/uploads/2015/05/food-safety-badge.jpg">
      </div>
      <div class="badge col l2 valign">
        <img src="http://www.kidneycoach.com/wp-content/uploads/2012/12/Optimized-HiRes.jpg">
      </div>

    </div>
    <div class="divider col l10 offset-l1">
    </div>
      <div class="row">
        <div class="banner-update col l3 offset-l3">
          <% if current_user && current_user.id == @farm.user_id %>
          <%= render 'update_banner', farm: @farm %>
          <% end %>
        </div>
        <div class="avatar-update col l4">
          <% if current_user && current_user.id == @farm.user_id %>
          <%= render 'update_avatar', farm: @farm %>
          <% end %>
        </div>
      </div>
    </div>

<div class="container">
    <div class="crops">
        <div class="carousel">
          <h3 align="center">What's available now?</h3>
            <% @available_crops.each do |c| %>
              <%= render 'available_crop_preview', crop: c, carousel_link: @available_crops.index(c)+2 %>
            <% end %>
        </div>
        <h5 style="margin-top:-20px;margin-bottom:60px" class="center"><%= link_to 'See All Our Crops', "/farms/#{@farm.id}/crops", data: { turbolinks: false } %></h5>
    </div>

  <div class="row">
    <div class="col m6">
      <div class="card blue-grey lighten-5">
        <div class="card-content black-text">
          <span class="card-title">About Us</span>
          <div class="divider">
          </div>
          <br>
          <p>
            <%= best_in_place_if (current_user && current_user.id == @farm.user_id), @farm, :about_farm, :as => :input, type: :textarea, :placeholder => 'Tell us about your farm!', ok_button: 'Save', cancel_button: 'Cancel' %>
          </p>
        </div>
        <div class="card-action">
          <% if @farm.csa_availability %>
          <%= link_to farm_boxes_path(@farm.id) do %>
          <button class="btn green white-text">Sign Up for Seasonal CSA</button>
          <% end %>
          <p>
            <!-- What are CSA boxes? How long does the subscription last? How many boxes will I get? Etc. -->
          </p>
          <% end %>
        </div>
      </div>
    </div>


    <div class="col m6">
      <div class="card blue-grey lighten-5">
        <div class="card-content black-text">
          <span class="card-title">Where are we located?</span>
          <div class="divider">
          </div>
          <br>
          <p>
            Our Address:
            <h5><%= best_in_place_if (current_user && current_user.id == @farm.user_id), @farm, :address, :as => :input, type: :textarea, :placeholder => "What is your farm's address?", ok_button: 'Save', cancel_button: 'Cancel' %></h5>
          </p>

          <div class="divider">
          </div>

          <ul class="list-group">
            <li class="list-group-item">
              <div id="map"></div>
              <div id="autocomplete_market_name_markets_path"></div>
              <%= form_for @new_market do |f| %>

              <% if f.object.errors.any? %>
              <div class="alert alert-danger">
                <strong>The following errors prevented saving:</strong>
                <ul>
                  <% f.object.errors.full_messages.each do |error| %>
                  <li><%= error %></li>
                  <% end %>
                </ul>
              </div>
              <% end %>
            </li>
            <li class="list-group-item">
              <div class="form-group">
                <%= f.label :name %>
                <%= f.autocomplete_field :name, autocomplete_market_name_markets_path, 'data-auto-focus' => true, class: 'form-control' %>
              </div>
              <div class="form-group">
                <%= f.label :address %>
                <%= f.text_field :address, class: 'form-control' %>
              </div>

              <div class="form-group market-day-dropdown">
                <%= f.label :market_day %>
                <%= select(:market, :market_day, ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'], :include_blank => true)%>
              </div>

              <%= f.hidden_field :farm_id, :value => @farm.id %>
              <br>
              <%= f.submit "Add a market", class: 'btn green', id: 'create-market' %>
              <% end %>
              <br>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  </div>



  <%= javascript_tag do %>
    window.farm = {lat: <%= @farm.lat %>, lng: <%= @farm.lng %>, id: <%= @farm.id %>}
    window.markets = <%= @market_data %>
  <% end %>

  <script async defer src="//maps.google.com/maps/api/js?key=AIzaSyC7a1ObkesRP36iQHZSe5q1TFxtiyXaJJI&callback=initMap"></script>
