  <div class="parallax-container">
    <div class="parallax"><img src=<%=@farm.banner_image%>></div>
  </div>

  <div class="section white">
    <div class="row valign-wrapper">
      <div class="profile-image col l2 offset-l1 valign">
        <img alt="" src=<%=@farm.profile_image%> class="circle">
      </div>

      <div class="names col l6">
        <ul>
          <li>
            <h2><%= best_in_place_if (current_user && current_user.id == @farm.user_id), @farm, :name, :as => :input, type: :textarea, placeholder: "What is the name of your farm?",  ok_button: 'Save', cancel_button: 'Cancel' %></h2>
          </li>
          <div class="card-content grey-text text-darken-1">
            <li>
              <h5><%= best_in_place_if (current_user && current_user.id == @farm.user_id), @farm, :farmer, :as => :input, placeholder: "Who are your farmers?",  ok_button: 'Save', cancel_button: 'Cancel' %>
              </h5>
            </li>
          </div>
        </ul>
      </div>
      <div class="safety col l1 valign">
        <img src="http://www.jamacfoods.com/wp-content/uploads/2015/05/food-safety-badge.jpg">
      </div>
      <div class="badge col l2 valign">
        <img src="http://www.kidneycoach.com/wp-content/uploads/2012/12/Optimized-HiRes.jpg">
      </div>

    </div>
    <div class="row">
  <div class="divider col l10 offset-l1">
  </div>
  </div>
    <br>
    <div class="row">
      <div class="banner-update col l3 offset-l3">
        <% if current_user && current_user.id == @farm.user_id %>
        <%= render 'update_banner', farm: @farm %>
        <% end %>
      </div>
      <div class="avatar-update col l4">
        <% if current_user && current_user.id == @farm.user_id %>
        <%= render 'update_avatar', farm: @farm %>
        <% end %>
      </div>
    </div>
  </div>



<div class="container">
  <div class="row">
    <div class="crops">
        <h3>What's available now?</h3>
        <div class="carousel">
          <% @available_crops.each do |c| %>
            <a class="carousel-item" href="#one!">
              <%= render 'available_crop_preview', crop: c, carousel_link: @available_crops.index(c) %>
            </a>
          <% end %>

          <a class="carousel-item" href="#2!"><img src="http://lorempixel.com/250/250/nature/2"></a>
          <a class="carousel-item" href="#3!"><img src="http://lorempixel.com/250/250/nature/3"></a>
          <a class="carousel-item" href="#4!"><img src="http://lorempixel.com/250/250/nature/4"></a>
          <a class="carousel-item" href="#5!"><img src="http://lorempixel.com/250/250/nature/5"></a>
          <a class="carousel-item" href="#6!"><img src="http://lorempixel.com/250/250/nature/2"></a>
          <a class="carousel-item" href="#7!"><img src="http://lorempixel.com/250/250/nature/3"></a>

        </div>
      <div class="center">
        <%= link_to 'See All Our Crops', "/farms/#{@farm.id}/crops" %>
      </div>
    </div>
  </div>




  <div class="row">
    <div class="col m6">
      <div class="card blue-grey lighten-5">
        <div class="card-content black-text">
          <span class="card-title">About Us</span>
          <div class="divider">
          </div>
          <br>
          <p>
            <%= best_in_place_if (current_user && current_user.id == @farm.user_id), @farm, :about_farm, :as => :input, type: :textarea, :placeholder => 'Tell us about your farm!', ok_button: 'Save', cancel_button: 'Cancel' %>
          </p>
        </div>
        <div class="card-action">
          <a href="#">This is where you'll see the CSA if it's available</a>
          <% if @farm.csa_availability %>
          <%= link_to farm_boxes_path(@farm.id) do %>
          <button class="btn black-text">Sign Up for Seasonal CSA</button>
          <% end %>
          <p>
            What are CSA boxes? How long does the subscription last? How many boxes will I get? Etc.
          </p>
          <% end %>
        </div>
      </div>
    </div>


    <div class="col m6">
      <div class="card blue-grey lighten-5">
        <div class="card-content black-text">
          <span class="card-title">Where are we located?</span>
          <div class="divider">
          </div>
          <br>
          <p>
            Our Address:
            <h5><%= best_in_place_if (current_user && current_user.id == @farm.user_id), @farm, :address, :as => :input, type: :textarea, :placeholder => "What is your farm's address?", ok_button: 'Save', cancel_button: 'Cancel' %></h5>
          </p>

          <div class="divider">
          </div>

          <ul class="list-group">
            <li class="list-group-item">
              <div id="map"></div>
              <div id="autocomplete_market_name_markets_path"></div>
              <%= form_for @new_market do |f| %>

              <% if f.object.errors.any? %>
              <div class="alert alert-danger">
                <strong>The following errors prevented saving:</strong>
                <ul>
                  <% f.object.errors.full_messages.each do |error| %>
                  <li><%= error %></li>
                  <% end %>
                </ul>
              </div>
              <% end %>
            </li>
            <li class="list-group-item">
              <div class="form-group">
                <label for="autocomplete-input">Name</label>
                <input name="market[name]" type="text" id="autocomplete-market-name" class="autocomplete" placeholder="What's the name of the market?">
              </div>
              <div class="form-group">
                <%= f.label :address %>
                <%= f.text_field :address, class: 'form-control' %>
              </div>

              <div class="form-group market-day-dropdown">
                <label>Market day</label>
                <select name="market[market_day]" id="market_market_day">
                  <option value="1">Monday</option>
                  <option value="2">Tuesday</option>
                  <option value="3">Wednesday</option>
                  <option value="4">Thursday</option>
                  <option value="5">Friday</option>
                  <option value="6" selected="selected">Saturday</option>
                  <option value="7">Sunday</option>
                </select>
              </div>

              <%= f.hidden_field :farm_id, :value => @farm.id %>
              <br>
              <%= f.submit "Add a market", class: 'btn green', id: 'create-market' %>
              <% end %>
              <br>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  </div>



  <%= javascript_tag do %>
    window.farm = {lat: <%= @farm.lat %>, lng: <%= @farm.lng %>, id: <%= @farm.id %>}
    window.markets = <%= @market_data %>
  <% end %>

  <script async defer src="//maps.google.com/maps/api/js?key=AIzaSyC7a1ObkesRP36iQHZSe5q1TFxtiyXaJJI&callback=initMap"></script>